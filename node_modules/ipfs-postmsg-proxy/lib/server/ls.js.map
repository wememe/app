{"version":3,"sources":["../../src/server/ls.js"],"names":["getIpfs","opts","ls","pre","lsPullStream","res","Promise","resolve","readFnName","PMS","sink"],"mappings":";;;;;;kBASe,UAAUA,OAAV,EAAmBC,IAAnB,EAAyB;AACtC,SAAO;AACLC,QAAI,wBAAO,SAAP,EAAkB,kBACpB,+BAAkB,CAAlB,CADoB,EAEpB,yBAAe,CAAf,CAFoB,EAGpBD,KAAKE,GAAL,CAAS,IAAT,CAHoB,EAIpB;AAAA;;AAAA,aAAa,uBAAUD,EAAV,2BAAb;AAAA,KAJoB,CAAlB,EAKDD,IALC,CADC;AAOLG,kBAAc,wBAAO,mBAAP,EAA4B,kBACxC,+BAAkB,CAAlB,CADwC,EAExC,yBAAe,CAAf,CAFwC,EAGxCH,KAAKE,GAAL,CAAS,cAAT,CAHwC,EAIxC,mBACE;AAAA;;AAAA,aAAa,wBAAUC,YAAV,4BAAb;AAAA,KADF,EAEE,UAACC,GAAD;AAAA,aAAS,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAa;AAChC,YAAMC,aAAa,wBAAnB;AACA,kCAAKH,GAAL,EAAUI,4BAAIC,IAAJ,CAASF,UAAT,EAAqBP,IAArB,CAAV;AACAM,gBAAQ,8BAAeC,UAAf,CAAR;AACD,OAJQ,CAAT;AAAA,KAFF,CAJwC,CAA5B,EAYXP,IAZW;AAPT,GAAP;AAqBD,C;;AA/BD;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA","file":"ls.js","sourcesContent":["import { expose } from 'postmsg-rpc'\nimport { pre, post } from 'prepost'\nimport pull from 'pull-stream'\nimport PMS from 'pull-postmsg-stream'\nimport shortid from 'shortid'\nimport { preCidFromJson } from '../serialization/cid'\nimport { preBufferFromJson } from '../serialization/buffer'\nimport { functionToJson } from '../serialization/function'\n\nexport default function (getIpfs, opts) {\n  return {\n    ls: expose('ipfs.ls', pre(\n      preBufferFromJson(0),\n      preCidFromJson(0),\n      opts.pre('ls'),\n      (...args) => getIpfs().ls(...args)\n    ), opts),\n    lsPullStream: expose('ipfs.lsPullStream', pre(\n      preBufferFromJson(0),\n      preCidFromJson(0),\n      opts.pre('lsPullStream'),\n      post(\n        (...args) => getIpfs().lsPullStream(...args),\n        (res) => new Promise((resolve) => {\n          const readFnName = shortid()\n          pull(res, PMS.sink(readFnName, opts))\n          resolve(functionToJson(readFnName))\n        })\n      )\n    ), opts)\n  }\n}\n"]}