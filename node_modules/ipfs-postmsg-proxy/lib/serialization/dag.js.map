{"version":3,"sources":["../../src/serialization/dag.js"],"names":["dagNodeFromJson","obj","Promise","resolve","reject","links","map","dagLinkFromJson","DAGNode","create","data","err","dagNode","dagNodeToJson","__ipfsPostMsgProxyType","dagLinkToJson","isDagNode","isDAGNode","isDagNodeJson","preDagNodeFromJson","index","args","then","preDagNodeToJson","DAGLink","name","size","multihash","link","Object","assign","toJSON","isDagLink","isDAGLink","isDagLinkJson","preDagLinkFromJson","preDagLinkToJson"],"mappings":"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","file":"dag.js","sourcesContent":["import { DAGNode, DAGLink } from 'ipld-dag-pb'\nimport { bufferFromJson, bufferToJson } from './buffer'\n\nexport const dagNodeFromJson = (obj) => {\n  return new Promise((resolve, reject) => {\n    const links = obj.links.map(dagLinkFromJson)\n    DAGNode.create(bufferFromJson(obj.data), links, (err, dagNode) => {\n      if (err) return reject(err)\n      resolve(dagNode)\n    })\n  })\n}\n\nexport const dagNodeToJson = (dagNode) => ({\n  __ipfsPostMsgProxyType: 'DAGNode',\n  links: dagNode.links.map(dagLinkToJson),\n  data: bufferToJson(dagNode.data)\n})\n\nexport const isDagNode = (obj) => DAGNode.isDAGNode(obj)\nexport const isDagNodeJson = (obj) => obj && obj.__ipfsPostMsgProxyType === 'DAGNode'\n\nexport const preDagNodeFromJson = (index) => {\n  return (...args) => {\n    if (isDagNodeJson(args[index])) {\n      return dagNodeFromJson(args[index])\n        .then((dagNode) => {\n          args[index] = dagNode\n          return args\n        })\n    }\n    return args\n  }\n}\n\nexport const preDagNodeToJson = (index) => {\n  return (...args) => {\n    if (isDagNode(args[index])) {\n      args[index] = dagNodeToJson(args[index])\n    }\n    return args\n  }\n}\n\nexport const dagLinkFromJson = (obj) => new DAGLink(obj.name, obj.size, obj.multihash)\n\nexport const dagLinkToJson = (link) => Object.assign(\n  { __ipfsPostMsgProxyType: 'DAGLink' },\n  link.toJSON()\n)\n\nexport const isDagLink = (obj) => DAGLink.isDAGLink(obj)\nexport const isDagLinkJson = (obj) => obj && obj.__ipfsPostMsgProxyType === 'DAGLink'\n\nexport const preDagLinkFromJson = (index) => {\n  return (...args) => {\n    if (isDagLinkJson(args[index])) {\n      args[index] = dagLinkFromJson(args[index])\n    }\n    return args\n  }\n}\n\nexport const preDagLinkToJson = (index) => {\n  return (...args) => {\n    if (isDagLink(args[index])) {\n      args[index] = dagLinkToJson(args[index])\n    }\n    return args\n  }\n}\n"]}