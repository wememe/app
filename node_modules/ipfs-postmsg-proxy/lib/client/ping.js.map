{"version":3,"sources":["../../src/client/ping.js"],"names":["opts","api","ping","callbackify","variadic","pingPullStream","res","PMS","source","name","deferred","defer","then","resolve","catch","err","abort","pingReadableStream","toStream","arguments"],"mappings":";;;;;;kBAOe,UAAUA,IAAV,EAAgB;AAC7B,MAAMC,MAAM;AACVC,UAAMC,sBAAYC,QAAZ,CAAqB,wBAAO,WAAP,EAAoBJ,IAApB,CAArB,CADI;AAEVK,oBAAiB,YAAM;AACrB,UAAMA,iBAAiB,mBACrB,wBAAO,qBAAP,EAA8BL,IAA9B,CADqB,EAErB,UAACM,GAAD;AAAA,eAASC,4BAAIC,MAAJ,CAAWF,IAAIG,IAAf,EAAqBT,IAArB,CAAT;AAAA,OAFqB,CAAvB;;AAKA,aAAO,YAAa;AAClB,YAAMU,WAAWC,oBAAMH,MAAN,EAAjB;;AAEAH,mDACGO,IADH,CACQ,UAACN,GAAD;AAAA,iBAASI,SAASG,OAAT,CAAiBP,GAAjB,CAAT;AAAA,SADR,EAEGQ,KAFH,CAES,UAACC,GAAD;AAAA,iBAASL,SAASM,KAAT,CAAeD,GAAf,CAAT;AAAA,SAFT;;AAIA,eAAOL,QAAP;AACD,OARD;AASD,KAfe,EAFN;AAkBVO,sBAlBU,gCAkBY;AACpB,aAAOC,6BAASV,MAAT,CAAgBP,IAAII,cAAJ,YAAsBc,SAAtB,CAAhB,CAAP;AACD;AApBS,GAAZ;;AAuBA,SAAOlB,GAAP;AACD,C;;AAhCD;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA","file":"ping.js","sourcesContent":["import { caller } from 'postmsg-rpc'\nimport callbackify from 'callbackify'\nimport defer from 'pull-defer'\nimport toStream from 'pull-stream-to-stream'\nimport PMS from 'pull-postmsg-stream'\nimport { post } from 'prepost'\n\nexport default function (opts) {\n  const api = {\n    ping: callbackify.variadic(caller('ipfs.ping', opts)),\n    pingPullStream: (() => {\n      const pingPullStream = post(\n        caller('ipfs.pingPullStream', opts),\n        (res) => PMS.source(res.name, opts)\n      )\n\n      return (...args) => {\n        const deferred = defer.source()\n\n        pingPullStream(...args)\n          .then((res) => deferred.resolve(res))\n          .catch((err) => deferred.abort(err))\n\n        return deferred\n      }\n    })(),\n    pingReadableStream () {\n      return toStream.source(api.pingPullStream(...arguments))\n    }\n  }\n\n  return api\n}\n"]}