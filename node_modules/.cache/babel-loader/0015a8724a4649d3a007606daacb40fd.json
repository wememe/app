{"ast":null,"code":"'use strict';\n\nvar log = require('debug')('ipfs:mfs:utils:update-mfs:root');\n\nvar waterfall = require('async/waterfall');\n\nvar CID = require('cids');\n\nvar _require = require('./constants'),\n    MFS_ROOT_KEY = _require.MFS_ROOT_KEY;\n\nvar updateMfsRoot = function updateMfsRoot(ipfs, buffer, callback) {\n  var repo = ipfs._repo;\n  var datastore = repo && repo.datastore;\n\n  if (!repo || !datastore) {\n    return callback(new Error('Please run jsipfs init first'));\n  }\n\n  var cid = new CID(buffer);\n  log(\"New MFS root will be \".concat(cid.toBaseEncodedString()));\n  waterfall([function (cb) {\n    if (repo.closed) {\n      log('Opening datastore');\n      return datastore.open(function (error) {\n        return cb(error);\n      });\n    }\n\n    log('Datastore was already open');\n    cb();\n  }, function (cb) {\n    return datastore.put(MFS_ROOT_KEY, cid.buffer, function (error) {\n      return cb(error);\n    });\n  }], function (error) {\n    return callback(error, cid);\n  });\n};\n\nmodule.exports = updateMfsRoot;","map":null,"metadata":{},"sourceType":"script"}