{"ast":null,"code":"'use strict';\n\nvar pull = require('pull-stream');\n\nvar cat = require('pull-cat'); // Logic to export a unixfs directory.\n\n\nmodule.exports = dirExporter;\n\nfunction dirExporter(cid, node, name, path, pathRest, resolve, size, dag, parent, depth) {\n  var accepts = pathRest[0];\n  var dir = {\n    name: name,\n    depth: depth,\n    path: path,\n    hash: cid,\n    size: node.size,\n    type: 'dir'\n  };\n  var streams = [pull(pull.values(node.links), pull.map(function (link) {\n    return {\n      depth: depth + 1,\n      size: link.size,\n      name: link.name,\n      path: path + '/' + link.name,\n      multihash: link.multihash,\n      linkName: link.name,\n      pathRest: pathRest.slice(1),\n      type: 'dir'\n    };\n  }), pull.filter(function (item) {\n    return accepts === undefined || item.linkName === accepts;\n  }), resolve)]; // place dir before if not specifying subtree\n\n  if (!pathRest.length) {\n    streams.unshift(pull.values([dir]));\n  }\n\n  return cat(streams);\n}","map":null,"metadata":{},"sourceType":"script"}