{"ast":null,"code":"var once = exports.once = function (value) {\n  return function (abort, cb) {\n    if (abort) return cb(abort);\n\n    if (value != null) {\n      var _value = value;\n      value = null;\n      cb(null, _value);\n    } else cb(true);\n  };\n};\n\nvar depthFirst = exports.depthFirst = function (start, createStream) {\n  var reads = [],\n      ended;\n  reads.unshift(once(start));\n  return function next(end, cb) {\n    if (!reads.length) return cb(true);\n    if (ended) return cb(ended);\n    reads[0](end, function (end, data) {\n      if (end) {\n        if (end !== true) {\n          ended = end;\n          reads.shift();\n\n          while (reads.length) {\n            reads.shift()(end, function () {});\n          }\n\n          return cb(end);\n        } //if this stream has ended, go to the next queue\n\n\n        reads.shift();\n        return next(null, cb);\n      }\n\n      reads.unshift(createStream(data));\n      cb(end, data);\n    });\n  };\n}; //width first is just like depth first,\n//but push each new stream onto the end of the queue\n\n\nvar widthFirst = exports.widthFirst = function (start, createStream) {\n  var reads = [];\n  reads.push(once(start));\n  return function next(end, cb) {\n    if (!reads.length) return cb(true);\n    reads[0](end, function (end, data) {\n      if (end) {\n        reads.shift();\n        return next(null, cb);\n      }\n\n      reads.push(createStream(data));\n      cb(end, data);\n    });\n  };\n}; //this came out different to the first (strm)\n//attempt at leafFirst, but it's still a valid\n//topological sort.\n\n\nvar leafFirst = exports.leafFirst = function (start, createStream) {\n  var reads = [];\n  var output = [];\n  reads.push(once(start));\n  return function next(end, cb) {\n    reads[0](end, function (end, data) {\n      if (end) {\n        reads.shift();\n        if (!output.length) return cb(true);\n        return cb(null, output.shift());\n      }\n\n      reads.unshift(createStream(data));\n      output.unshift(data);\n      next(null, cb);\n    });\n  };\n};","map":null,"metadata":{},"sourceType":"script"}