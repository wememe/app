{"ast":null,"code":"import _defineProperty from \"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { address } from '../utils/address';\nimport { store } from './store';\nimport * as routes from '../utils/routes';\nimport history from '../history';\nexport var checkWeb3Wallet = function checkWeb3Wallet() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(dispatch) {\n        var cp, isToshi, isCipher, isMetaMask, currentWallet;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                cp = typeof window.web3 !== 'undefined' ? window.web3.currentProvider : null; // eslint-disable-line no-undef\n\n                if (cp) {\n                  isToshi = !!cp.isToshi;\n                  isCipher = !!cp.isCipher;\n                  isMetaMask = !!cp.isMetaMask;\n\n                  if (isToshi) {\n                    currentWallet = 'isToshi';\n                  } else if (isCipher) {\n                    currentWallet = 'isCipher';\n                  } else if (isMetaMask) {\n                    currentWallet = 'isMetaMask';\n                  }\n                }\n\n                dispatch({\n                  type: 'CHECK_WALLET',\n                  hasWallet: typeof window.web3 !== 'undefined',\n                  // eslint-disable-line no-undef\n                  downloadBanner: typeof window.web3 === 'undefined',\n                  // eslint-disable-line no-undef\n                  mobileWalletRequiredModal: typeof window.web3 === 'undefined',\n                  // eslint-disable-line no-undef\n                  currentWallet: currentWallet\n                });\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }()\n  );\n}; // inject for breaking change\n\nexport var requestAccess = function requestAccess(directLogin) {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref2 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(dispatch) {\n        var accounts, accountsPromise;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                accountsPromise = new Promise(function (resolve, reject) {\n                  window.web3.eth.getAccounts(function (e, accountsFound) {\n                    // eslint-disable-line no-undef\n                    if (e != null) {\n                      reject(e);\n                    } else {\n                      resolve(accountsFound);\n                    }\n                  });\n                });\n\n                if (!window.ethereum) {\n                  _context2.next = 25;\n                  break;\n                }\n\n                _context2.prev = 2;\n                window.web3 = new Web3(ethereum); // eslint-disable-line no-undef\n\n                dispatch({\n                  type: 'HANDLE_ACCESS_MODAL',\n                  allowAccessModal: true,\n                  directLogin: directLogin\n                });\n                _context2.next = 7;\n                return window.ethereum.enable();\n\n              case 7:\n                accounts = _context2.sent;\n\n                if (accounts) {\n                  _context2.next = 14;\n                  break;\n                }\n\n                _context2.next = 11;\n                return accountsPromise;\n\n              case 11:\n                _context2.t0 = _context2.sent;\n                _context2.next = 15;\n                break;\n\n              case 14:\n                _context2.t0 = accounts;\n\n              case 15:\n                accounts = _context2.t0;\n                dispatch({\n                  type: 'UPDATE_ADDRESSES',\n                  isSignedIntoWallet: accounts.length > 0 || store.getState().threeBox.currentWallet === 'isToshi',\n                  isLoggedIn: accounts && Box.isLoggedIn(accounts[0]),\n                  // eslint-disable-line no-undef\n                  accountAddress: accounts[0],\n                  allowAccessModal: false\n                });\n                _context2.next = 23;\n                break;\n\n              case 19:\n                _context2.prev = 19;\n                _context2.t1 = _context2[\"catch\"](2);\n                history.push(routes.LANDING);\n                dispatch({\n                  type: 'HANDLE_DENIED_ACCESS_MODAL',\n                  accessDeniedModal: true,\n                  allowAccessModal: false\n                });\n\n              case 23:\n                _context2.next = 34;\n                break;\n\n              case 25:\n                if (!window.web3) {\n                  _context2.next = 33;\n                  break;\n                }\n\n                // eslint-disable-line no-undef\n                window.web3 = new Web3(web3.currentProvider); // eslint-disable-line no-undef\n\n                _context2.next = 29;\n                return accountsPromise;\n\n              case 29:\n                accounts = _context2.sent;\n                dispatch({\n                  type: 'UPDATE_ADDRESSES',\n                  isSignedIntoWallet: accounts.length > 0 || store.getState().threeBox.currentWallet === 'isToshi',\n                  isLoggedIn: accounts && Box.isLoggedIn(accounts[0]) // eslint-disable-line no-undef\n\n                });\n                _context2.next = 34;\n                break;\n\n              case 33:\n                console.log('Non-Ethereum browser detected. You should consider trying MetaMask!');\n\n              case 34:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[2, 19]]);\n      }));\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }()\n  );\n}; // if has web3 wallet\n\nexport var checkNetwork = function checkNetwork() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref3 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee3(dispatch) {\n        var checkNetworkFunc, currentNetwork, prevPrevNetwork, prevNetwork, shouldShowSwitchNetwork;\n        return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                checkNetworkFunc = new Promise(function (resolve) {\n                  window.web3.version.getNetwork(function (err, netId) {\n                    // eslint-disable-line no-undef\n                    switch (netId) {\n                      case '1':\n                        resolve('Main');\n                        break;\n\n                      case '2':\n                        resolve('Morder');\n                        break;\n\n                      case '3':\n                        resolve('Ropsten');\n                        break;\n\n                      case '4':\n                        resolve('Rinkeby');\n                        break;\n\n                      case '42':\n                        resolve('Kovan');\n                        break;\n\n                      default:\n                        resolve('Unknown');\n                    }\n                  });\n                }); // // check network, compatible with old & new v of MetaMask\n\n                if (!window.web3.eth.net) {\n                  _context3.next = 6;\n                  break;\n                }\n\n                _context3.next = 4;\n                return window.web3.eth.net.getNetworkType() // eslint-disable-line no-undef\n                .then(function (network) {\n                  currentNetwork = network;\n                });\n\n              case 4:\n                _context3.next = 8;\n                break;\n\n              case 6:\n                _context3.next = 8;\n                return checkNetworkFunc.then(function (network) {\n                  currentNetwork = network;\n                });\n\n              case 8:\n                prevPrevNetwork = window.localStorage.getItem('prevNetwork'); // eslint-disable-line no-undef\n\n                prevNetwork = window.localStorage.getItem('currentNetwork'); // eslint-disable-line no-undef\n\n                shouldShowSwitchNetwork = window.localStorage.getItem('shouldShowSwitchNetwork'); // eslint-disable-line no-undef\n\n                window.localStorage.setItem('prevPrevNetwork', prevPrevNetwork); // eslint-disable-line no-undef\n\n                window.localStorage.setItem('prevNetwork', prevNetwork); // eslint-disable-line no-undef\n\n                window.localStorage.setItem('currentNetwork', currentNetwork); // eslint-disable-line no-undef\n\n                if (prevNetwork && prevNetwork !== currentNetwork && store.getState().threeBox.isLoggedIn && shouldShowSwitchNetwork === 'true') {\n                  window.localStorage.setItem('shouldShowSwitchNetwork', false); // eslint-disable-line no-undef\n\n                  dispatch({\n                    type: 'DIFFERENT_NETWORK',\n                    showDifferentNetworkModal: true,\n                    currentNetwork: currentNetwork,\n                    prevNetwork: prevNetwork,\n                    prevPrevNetwork: prevPrevNetwork\n                  });\n                } else {\n                  window.localStorage.setItem('shouldShowSwitchNetwork', true); // eslint-disable-line no-undef\n\n                  dispatch({\n                    type: 'UPDATE_NETWORK',\n                    currentNetwork: currentNetwork,\n                    prevNetwork: prevNetwork,\n                    prevPrevNetwork: prevPrevNetwork\n                  });\n                }\n\n              case 15:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      return function (_x3) {\n        return _ref3.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getBox = function getBox(fromSignIn) {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref4 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(dispatch) {\n        var consentGiven, opts, box, memberSince;\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                dispatch({\n                  type: 'HANDLE_CONSENT_MODAL',\n                  provideConsent: true\n                });\n\n                consentGiven = function consentGiven() {\n                  if (fromSignIn) history.push(routes.PROFILE);\n                  dispatch({\n                    type: 'LOADING_3BOX'\n                  });\n                  dispatch({\n                    type: 'LOADING_ACTIVITY'\n                  });\n                };\n\n                opts = {\n                  consentCallback: consentGiven\n                };\n                _context4.prev = 3;\n                _context4.next = 6;\n                return Box // eslint-disable-line no-undef\n                .openBox(store.getState().threeBox.accountAddress || address, window.web3.currentProvider, // eslint-disable-line no-undef\n                opts);\n\n              case 6:\n                box = _context4.sent;\n                dispatch({\n                  type: 'UPDATE_THREEBOX',\n                  ifFetchingThreeBox: false,\n                  isLoggedIn: true,\n                  box: box\n                });\n                _context4.next = 10;\n                return store.getState().threeBox.box.public.get('memberSince');\n\n              case 10:\n                memberSince = _context4.sent;\n                box.onSyncDone(function () {\n                  var publicActivity = store.getState().threeBox.box.public.log;\n                  var privateActivity = store.getState().threeBox.box.private.log;\n\n                  if (!privateActivity.length && !publicActivity.length) {\n                    dispatch({\n                      type: 'HANDLE_ONBOARDING_MODAL',\n                      onBoardingModal: true\n                    });\n                    var date = Date.now();\n                    var dateJoined = new Date(date);\n                    var memberSinceDate = \"\".concat(dateJoined.getMonth() + 1, \"/\").concat(dateJoined.getDate(), \"/\").concat(dateJoined.getFullYear());\n                    store.getState().threeBox.box.public.set('memberSince', dateJoined);\n                    dispatch({\n                      type: 'GET_PUBLIC_MEMBERSINCE',\n                      memberSince: memberSinceDate\n                    });\n                    history.push(routes.EDITPROFILE);\n                  } else if (!memberSince && (privateActivity.length || publicActivity.length)) {\n                    store.getState().threeBox.box.public.set('memberSince', 'Alpha');\n                  }\n\n                  dispatch({\n                    type: 'UPDATE_THREEBOX',\n                    ifFetchingThreeBox: false,\n                    isLoggedIn: true,\n                    box: box\n                  });\n                });\n                _context4.next = 17;\n                break;\n\n              case 14:\n                _context4.prev = 14;\n                _context4.t0 = _context4[\"catch\"](3);\n                dispatch({\n                  type: 'FAILED_LOADING_3BOX',\n                  errorMessage: _context4.t0,\n                  showErrorModal: true,\n                  provideConsent: false\n                });\n\n              case 17:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this, [[3, 14]]);\n      }));\n\n      return function (_x4) {\n        return _ref4.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getActivity = function getActivity() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref5 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee5(dispatch) {\n        var activity, publicActivity, privateActivity, feed, feedByAddress;\n        return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                _context5.prev = 0;\n                dispatch({\n                  type: 'LOADING_ACTIVITY'\n                });\n                _context5.next = 4;\n                return ThreeBoxActivity.get(address);\n\n              case 4:\n                activity = _context5.sent;\n                // eslint-disable-line no-undef\n                // add datatype\n                activity.internal = activity.internal.map(function (object) {\n                  return Object.assign({\n                    dataType: 'Internal'\n                  }, object);\n                });\n                activity.txs = activity.txs.map(function (object) {\n                  return Object.assign({\n                    dataType: 'Txs'\n                  }, object);\n                });\n                activity.token = activity.token.map(function (object) {\n                  return Object.assign({\n                    dataType: 'Token'\n                  }, object);\n                });\n                _context5.next = 10;\n                return store.getState().threeBox.box.public.log;\n\n              case 10:\n                publicActivity = _context5.sent;\n                _context5.next = 13;\n                return store.getState().threeBox.box.private.log;\n\n              case 13:\n                privateActivity = _context5.sent;\n                publicActivity = publicActivity.map(function (object) {\n                  object.timeStamp = object.timeStamp && object.timeStamp.toString().substring(0, 10);\n                  return Object.assign({\n                    dataType: 'Public'\n                  }, object);\n                });\n                privateActivity = privateActivity.map(function (object) {\n                  object.timeStamp = object.timeStamp && object.timeStamp.toString().substring(0, 10);\n                  return Object.assign({\n                    dataType: 'Private'\n                  }, object);\n                });\n                feed = activity.internal.concat(activity.txs).concat(activity.token).concat(publicActivity).concat(privateActivity); // if timestamp is undefined, give it the timestamp of the previous entry\n\n                feed.map(function (item, i) {\n                  var feedItem = item;\n\n                  if (!feedItem.timeStamp) {\n                    var deletedTime = parseInt(feed[i - 1].timeStamp, 10) + 1;\n                    feedItem.timeStamp = deletedTime.toString();\n                  }\n\n                  return feedItem;\n                });\n                feed.sort(function (a, b) {\n                  return b.timeStamp - a.timeStamp;\n                }); // order feed chronologically and by address\n\n                feedByAddress = [];\n                feed.forEach(function (item) {\n                  var othersAddress = item.from === address ? item.to : item.from;\n\n                  if (feedByAddress.length > 0 && Object.keys(feedByAddress[feedByAddress.length - 1])[0] === othersAddress) {\n                    feedByAddress[feedByAddress.length - 1][othersAddress].push(item);\n                  } else if (feedByAddress.length > 0 && Object.keys(feedByAddress[feedByAddress.length - 1])[0] === 'threeBox' && (item.dataType === 'Public' || item.dataType === 'Private')) {\n                    feedByAddress[feedByAddress.length - 1].threeBox.push(item);\n                  } else if (item.dataType === 'Public' || item.dataType === 'Private') {\n                    feedByAddress.push({\n                      threeBox: [item]\n                    });\n                  } else {\n                    feedByAddress.push(_defineProperty({}, othersAddress, [item]));\n                  }\n                });\n                dispatch({\n                  type: 'UPDATE_ACTIVITY',\n                  feedByAddress: feedByAddress,\n                  ifFetchingActivity: false,\n                  isLoggedIn: true\n                });\n                _context5.next = 27;\n                break;\n\n              case 24:\n                _context5.prev = 24;\n                _context5.t0 = _context5[\"catch\"](0);\n                dispatch({\n                  type: 'FAILED_LOADING_ACTIVITY',\n                  feedByAddress: [],\n                  ifFetchingActivity: false,\n                  errorMessage: _context5.t0,\n                  showErrorModal: true,\n                  provideConsent: false\n                });\n\n              case 27:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this, [[0, 24]]);\n      }));\n\n      return function (_x5) {\n        return _ref5.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicName = function getPublicName() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref6 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee6(dispatch) {\n        var name;\n        return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return store.getState().threeBox.box.public.get('name');\n\n              case 2:\n                name = _context6.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_NAME',\n                  name: name\n                });\n\n              case 4:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      return function (_x6) {\n        return _ref6.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicGithub = function getPublicGithub() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref7 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee7(dispatch) {\n        var github;\n        return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.next = 2;\n                return store.getState().threeBox.box.public.get('github');\n\n              case 2:\n                github = _context7.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_GITHUB',\n                  github: github\n                });\n\n              case 4:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      return function (_x7) {\n        return _ref7.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicDescription = function getPublicDescription() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref8 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee8(dispatch) {\n        var description;\n        return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _context8.next = 2;\n                return store.getState().threeBox.box.public.get('description');\n\n              case 2:\n                description = _context8.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_DESCRIPTION',\n                  description: description\n                });\n\n              case 4:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      return function (_x8) {\n        return _ref8.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicLocation = function getPublicLocation() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref9 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee9(dispatch) {\n        var location;\n        return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                _context9.next = 2;\n                return store.getState().threeBox.box.public.get('location');\n\n              case 2:\n                location = _context9.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_LOCATION',\n                  location: location\n                });\n\n              case 4:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      return function (_x9) {\n        return _ref9.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicWebsite = function getPublicWebsite() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref10 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee10(dispatch) {\n        var website;\n        return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                _context10.next = 2;\n                return store.getState().threeBox.box.public.get('website');\n\n              case 2:\n                website = _context10.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_WEBSITE',\n                  website: website\n                });\n\n              case 4:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      return function (_x10) {\n        return _ref10.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicEmployer = function getPublicEmployer() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref11 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee11(dispatch) {\n        var employer;\n        return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n          while (1) {\n            switch (_context11.prev = _context11.next) {\n              case 0:\n                _context11.next = 2;\n                return store.getState().threeBox.box.public.get('employer');\n\n              case 2:\n                employer = _context11.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_EMPLOYER',\n                  employer: employer\n                });\n\n              case 4:\n              case \"end\":\n                return _context11.stop();\n            }\n          }\n        }, _callee11, this);\n      }));\n\n      return function (_x11) {\n        return _ref11.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicJob = function getPublicJob() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref12 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee12(dispatch) {\n        var job;\n        return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                _context12.next = 2;\n                return store.getState().threeBox.box.public.get('job');\n\n              case 2:\n                job = _context12.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_JOB',\n                  job: job\n                });\n\n              case 4:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      return function (_x12) {\n        return _ref12.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicMemberSince = function getPublicMemberSince() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref13 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee13(dispatch) {\n        var date, memberSince, memberSinceDate;\n        return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n          while (1) {\n            switch (_context13.prev = _context13.next) {\n              case 0:\n                _context13.next = 2;\n                return store.getState().threeBox.box.public.get('memberSince');\n\n              case 2:\n                date = _context13.sent;\n                memberSince = date && new Date(date);\n                memberSinceDate = date && \"\".concat(memberSince.getMonth() + 1, \"/\").concat(memberSince.getDate(), \"/\").concat(memberSince.getFullYear());\n                dispatch({\n                  type: 'GET_PUBLIC_MEMBERSINCE',\n                  memberSince: memberSinceDate\n                });\n\n              case 6:\n              case \"end\":\n                return _context13.stop();\n            }\n          }\n        }, _callee13, this);\n      }));\n\n      return function (_x13) {\n        return _ref13.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicSchool = function getPublicSchool() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref14 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee14(dispatch) {\n        var school;\n        return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n          while (1) {\n            switch (_context14.prev = _context14.next) {\n              case 0:\n                _context14.next = 2;\n                return store.getState().threeBox.box.public.get('school');\n\n              case 2:\n                school = _context14.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_SCHOOL',\n                  school: school\n                });\n\n              case 4:\n              case \"end\":\n                return _context14.stop();\n            }\n          }\n        }, _callee14, this);\n      }));\n\n      return function (_x14) {\n        return _ref14.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicDegree = function getPublicDegree() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref15 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee15(dispatch) {\n        var degree;\n        return _regeneratorRuntime.wrap(function _callee15$(_context15) {\n          while (1) {\n            switch (_context15.prev = _context15.next) {\n              case 0:\n                _context15.next = 2;\n                return store.getState().threeBox.box.public.get('degree');\n\n              case 2:\n                degree = _context15.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_DEGREE',\n                  degree: degree\n                });\n\n              case 4:\n              case \"end\":\n                return _context15.stop();\n            }\n          }\n        }, _callee15, this);\n      }));\n\n      return function (_x15) {\n        return _ref15.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicImage = function getPublicImage() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref16 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee16(dispatch) {\n        var image;\n        return _regeneratorRuntime.wrap(function _callee16$(_context16) {\n          while (1) {\n            switch (_context16.prev = _context16.next) {\n              case 0:\n                _context16.next = 2;\n                return store.getState().threeBox.box.public.get('image');\n\n              case 2:\n                image = _context16.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_IMAGE',\n                  image: image\n                });\n\n              case 4:\n              case \"end\":\n                return _context16.stop();\n            }\n          }\n        }, _callee16, this);\n      }));\n\n      return function (_x16) {\n        return _ref16.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicCoverPhoto = function getPublicCoverPhoto() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref17 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee17(dispatch) {\n        var coverPhoto;\n        return _regeneratorRuntime.wrap(function _callee17$(_context17) {\n          while (1) {\n            switch (_context17.prev = _context17.next) {\n              case 0:\n                _context17.next = 2;\n                return store.getState().threeBox.box.public.get('coverPhoto');\n\n              case 2:\n                coverPhoto = _context17.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_COVERPHOTO',\n                  coverPhoto: coverPhoto\n                });\n\n              case 4:\n              case \"end\":\n                return _context17.stop();\n            }\n          }\n        }, _callee17, this);\n      }));\n\n      return function (_x17) {\n        return _ref17.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicEmoji = function getPublicEmoji() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref18 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee18(dispatch) {\n        var emoji;\n        return _regeneratorRuntime.wrap(function _callee18$(_context18) {\n          while (1) {\n            switch (_context18.prev = _context18.next) {\n              case 0:\n                _context18.next = 2;\n                return store.getState().threeBox.box.public.get('emoji');\n\n              case 2:\n                emoji = _context18.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_EMOJI',\n                  emoji: emoji\n                });\n\n              case 4:\n              case \"end\":\n                return _context18.stop();\n            }\n          }\n        }, _callee18, this);\n      }));\n\n      return function (_x18) {\n        return _ref18.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicSubject = function getPublicSubject() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref19 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee19(dispatch) {\n        var major;\n        return _regeneratorRuntime.wrap(function _callee19$(_context19) {\n          while (1) {\n            switch (_context19.prev = _context19.next) {\n              case 0:\n                _context19.next = 2;\n                return store.getState().threeBox.box.public.get('major');\n\n              case 2:\n                major = _context19.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_MAJOR',\n                  major: major\n                });\n\n              case 4:\n              case \"end\":\n                return _context19.stop();\n            }\n          }\n        }, _callee19, this);\n      }));\n\n      return function (_x19) {\n        return _ref19.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicYear = function getPublicYear() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref20 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee20(dispatch) {\n        var year;\n        return _regeneratorRuntime.wrap(function _callee20$(_context20) {\n          while (1) {\n            switch (_context20.prev = _context20.next) {\n              case 0:\n                _context20.next = 2;\n                return store.getState().threeBox.box.public.get('year');\n\n              case 2:\n                year = _context20.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_YEAR',\n                  year: year\n                });\n\n              case 4:\n              case \"end\":\n                return _context20.stop();\n            }\n          }\n        }, _callee20, this);\n      }));\n\n      return function (_x20) {\n        return _ref20.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPrivateEmail = function getPrivateEmail() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref21 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee21(dispatch) {\n        var email;\n        return _regeneratorRuntime.wrap(function _callee21$(_context21) {\n          while (1) {\n            switch (_context21.prev = _context21.next) {\n              case 0:\n                _context21.next = 2;\n                return store.getState().threeBox.box.private.get('email');\n\n              case 2:\n                email = _context21.sent;\n                dispatch({\n                  type: 'GET_PRIVATE_EMAIL',\n                  email: email\n                });\n\n              case 4:\n              case \"end\":\n                return _context21.stop();\n            }\n          }\n        }, _callee21, this);\n      }));\n\n      return function (_x21) {\n        return _ref21.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPrivateBirthday = function getPrivateBirthday() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref22 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee22(dispatch) {\n        var birthday;\n        return _regeneratorRuntime.wrap(function _callee22$(_context22) {\n          while (1) {\n            switch (_context22.prev = _context22.next) {\n              case 0:\n                _context22.next = 2;\n                return store.getState().threeBox.box.private.get('birthday');\n\n              case 2:\n                birthday = _context22.sent;\n                dispatch({\n                  type: 'GET_PRIVATE_BIRTHDAY',\n                  birthday: birthday\n                });\n\n              case 4:\n              case \"end\":\n                return _context22.stop();\n            }\n          }\n        }, _callee22, this);\n      }));\n\n      return function (_x22) {\n        return _ref22.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var getPublicStatus = function getPublicStatus() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref23 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee23(dispatch) {\n        var status;\n        return _regeneratorRuntime.wrap(function _callee23$(_context23) {\n          while (1) {\n            switch (_context23.prev = _context23.next) {\n              case 0:\n                _context23.next = 2;\n                return store.getState().threeBox.box.public.get('status');\n\n              case 2:\n                status = _context23.sent;\n                dispatch({\n                  type: 'GET_PUBLIC_STATUS',\n                  status: status\n                });\n\n              case 4:\n              case \"end\":\n                return _context23.stop();\n            }\n          }\n        }, _callee23, this);\n      }));\n\n      return function (_x23) {\n        return _ref23.apply(this, arguments);\n      };\n    }()\n  );\n};\nexport var handleSignOut = function handleSignOut() {\n  return (\n    /*#__PURE__*/\n    function () {\n      var _ref24 = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee24(dispatch) {\n        return _regeneratorRuntime.wrap(function _callee24$(_context24) {\n          while (1) {\n            switch (_context24.prev = _context24.next) {\n              case 0:\n                if (store.getState().threeBox.isLoggedIn) {\n                  store.getState().threeBox.box.logout();\n                  dispatch({\n                    type: 'HANDLE_SIGNOUT',\n                    isLoggedIn: false\n                  });\n                }\n\n                history.push(routes.LANDING);\n\n              case 2:\n              case \"end\":\n                return _context24.stop();\n            }\n          }\n        }, _callee24, this);\n      }));\n\n      return function (_x24) {\n        return _ref24.apply(this, arguments);\n      };\n    }()\n  );\n}; // export const signInGetBox = () => async (dispatch) => {\n//   dispatch({\n//     type: 'HANDLE_CONSENT_MODAL',\n//     provideConsent: true,\n//   });\n//   const consentGiven = () => {\n//     history.push(routes.PROFILE);\n//     dispatch({\n//       type: 'LOADING_3BOX',\n//     });\n//     dispatch({\n//       type: 'LOADING_ACTIVITY',\n//     });\n//   };\n//   const opts = {\n//     consentCallback: consentGiven,\n//   };\n//   try {\n//     const box = await Box // eslint-disable-line no-undef\n//       .openBox(\n//         store.getState().threeBox.accountAddress || address,\n//         window.web3.currentProvider, // eslint-disable-line no-undef\n//         opts,\n//       );\n//     dispatch({\n//       type: 'UPDATE_THREEBOX',\n//       ifFetchingThreeBox: false,\n//       isLoggedIn: true,\n//       box,\n//     });\n//     const memberSince = await store.getState().threeBox.box.public.get('memberSince');\n//     box.onSyncDone(() => {\n//       const publicActivity = store.getState().threeBox.box.public.log;\n//       const privateActivity = store.getState().threeBox.box.private.log;\n//       if (!privateActivity.length && !publicActivity.length) {\n//         dispatch({\n//           type: 'HANDLE_ONBOARDING_MODAL',\n//           onBoardingModal: true,\n//         });\n//         store.getState().threeBox.box.public.set('memberSince', Date.now());\n//         history.push(routes.EDITPROFILE);\n//       } else if (!memberSince && (privateActivity.length || publicActivity.length)) {\n//         store.getState().threeBox.box.public.set('memberSince', 'Alpha');\n//       }\n//       dispatch({\n//         type: 'UPDATE_THREEBOX',\n//         ifFetchingThreeBox: false,\n//         isLoggedIn: true,\n//         box,\n//       });\n//     });\n//   } catch (err) {\n//     dispatch({\n//       type: 'FAILED_LOADING_3BOX',\n//       errorMessage: err,\n//       showErrorModal: true,\n//       provideConsent: false,\n//     });\n//   }\n// };\n// export const profileGetBox = () => async (dispatch) => {\n//   dispatch({\n//     type: 'HANDLE_CONSENT_MODAL',\n//     provideConsent: true,\n//   });\n//   const consentGiven = () => {\n//     dispatch({\n//       type: 'LOADING_3BOX',\n//     });\n//     dispatch({\n//       type: 'LOADING_ACTIVITY',\n//     });\n//   };\n//   const opts = {\n//     consentCallback: consentGiven,\n//   };\n//   try {\n//     const box = await Box // eslint-disable-line no-undef\n//       .openBox(\n//         store.getState().threeBox.accountAddress || address,\n//         window.web3.currentProvider, // eslint-disable-line no-undef\n//         opts,\n//       );\n//     dispatch({\n//       type: 'UPDATE_THREEBOX',\n//       ifFetchingThreeBox: false,\n//       box,\n//       isLoggedIn: true,\n//     });\n//     const memberSince = await store.getState().threeBox.box.public.get('memberSince');\n//     box.onSyncDone(() => {\n//       const publicActivity = store.getState().threeBox.box.public.log;\n//       const privateActivity = store.getState().threeBox.box.private.log;\n//       if (!privateActivity.length && !publicActivity.length) {\n//         dispatch({\n//           type: 'HANDLE_ONBOARDING_MODAL',\n//           onBoardingModal: true,\n//         });\n//         history.push(routes.EDITPROFILE);\n//       } else if (!memberSince && (privateActivity.length || publicActivity.length)) {\n//         store.getState().threeBox.box.public.set('memberSince', 'Alpha');\n//       }\n//       dispatch({\n//         type: 'UPDATE_THREEBOX',\n//         ifFetchingThreeBox: false,\n//         isLoggedIn: true,\n//         box,\n//       });\n//     });\n//   } catch (err) {\n//     dispatch({\n//       type: 'FAILED_LOADING_3BOX',\n//       errorMessage: err,\n//       showErrorModal: true,\n//       provideConsent: false,\n//     });\n//   }\n// };","map":{"version":3,"sources":["/Users/kenzo/Desktop/3box-dapp/src/state/actions.js"],"names":["address","store","routes","history","checkWeb3Wallet","dispatch","cp","window","web3","currentProvider","isToshi","isCipher","isMetaMask","currentWallet","type","hasWallet","downloadBanner","mobileWalletRequiredModal","requestAccess","directLogin","accountsPromise","Promise","resolve","reject","eth","getAccounts","e","accountsFound","ethereum","Web3","allowAccessModal","enable","accounts","isSignedIntoWallet","length","getState","threeBox","isLoggedIn","Box","accountAddress","push","LANDING","accessDeniedModal","console","log","checkNetwork","checkNetworkFunc","version","getNetwork","err","netId","net","getNetworkType","then","network","currentNetwork","prevPrevNetwork","localStorage","getItem","prevNetwork","shouldShowSwitchNetwork","setItem","showDifferentNetworkModal","getBox","fromSignIn","provideConsent","consentGiven","PROFILE","opts","consentCallback","openBox","box","ifFetchingThreeBox","public","get","memberSince","onSyncDone","publicActivity","privateActivity","private","onBoardingModal","date","Date","now","dateJoined","memberSinceDate","getMonth","getDate","getFullYear","set","EDITPROFILE","errorMessage","showErrorModal","getActivity","ThreeBoxActivity","activity","internal","map","object","Object","assign","dataType","txs","token","timeStamp","toString","substring","feed","concat","item","i","feedItem","deletedTime","parseInt","sort","a","b","feedByAddress","forEach","othersAddress","from","to","keys","ifFetchingActivity","getPublicName","name","getPublicGithub","github","getPublicDescription","description","getPublicLocation","location","getPublicWebsite","website","getPublicEmployer","employer","getPublicJob","job","getPublicMemberSince","getPublicSchool","school","getPublicDegree","degree","getPublicImage","image","getPublicCoverPhoto","coverPhoto","getPublicEmoji","emoji","getPublicSubject","major","getPublicYear","year","getPrivateEmail","email","getPrivateBirthday","birthday","getPublicStatus","status","handleSignOut","logout"],"mappings":"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","sourcesContent":["import {\n  address,\n} from '../utils/address';\n\nimport {\n  store,\n} from './store';\n\nimport * as routes from '../utils/routes';\nimport history from '../history';\n\nexport const checkWeb3Wallet = () => async (dispatch) => {\n  const cp = typeof window.web3 !== 'undefined' ? window.web3.currentProvider : null; // eslint-disable-line no-undef\n\n  let isToshi;\n  let isCipher;\n  let isMetaMask;\n  let currentWallet;\n\n  if (cp) {\n    isToshi = !!cp.isToshi;\n    isCipher = !!cp.isCipher;\n    isMetaMask = !!cp.isMetaMask;\n\n    if (isToshi) {\n      currentWallet = 'isToshi';\n    } else if (isCipher) {\n      currentWallet = 'isCipher';\n    } else if (isMetaMask) {\n      currentWallet = 'isMetaMask';\n    }\n  }\n\n  dispatch({\n    type: 'CHECK_WALLET',\n    hasWallet: typeof window.web3 !== 'undefined', // eslint-disable-line no-undef\n    downloadBanner: typeof window.web3 === 'undefined', // eslint-disable-line no-undef\n    mobileWalletRequiredModal: typeof window.web3 === 'undefined', // eslint-disable-line no-undef\n    currentWallet,\n  });\n};\n\n// inject for breaking change\nexport const requestAccess = directLogin => async (dispatch) => {\n  let accounts;\n  const accountsPromise = new Promise((resolve, reject) => {\n    window.web3.eth.getAccounts((e, accountsFound) => { // eslint-disable-line no-undef\n      if (e != null) {\n        reject(e);\n      } else {\n        resolve(accountsFound);\n      }\n    });\n  });\n\n  if (window.ethereum) { // eslint-disable-line no-undef\n    try {\n      window.web3 = new Web3(ethereum); // eslint-disable-line no-undef\n      dispatch({\n        type: 'HANDLE_ACCESS_MODAL',\n        allowAccessModal: true,\n        directLogin,\n      });\n\n      accounts = await window.ethereum.enable(); // eslint-disable-line no-undef\n      accounts = !accounts ? await accountsPromise : accounts;\n\n      dispatch({\n        type: 'UPDATE_ADDRESSES',\n        isSignedIntoWallet: accounts.length > 0 || store.getState().threeBox.currentWallet === 'isToshi',\n        isLoggedIn: accounts && Box.isLoggedIn(accounts[0]), // eslint-disable-line no-undef\n        accountAddress: accounts[0],\n        allowAccessModal: false,\n      });\n    } catch (error) {\n      history.push(routes.LANDING);\n      dispatch({\n        type: 'HANDLE_DENIED_ACCESS_MODAL',\n        accessDeniedModal: true,\n        allowAccessModal: false,\n      });\n    }\n  } else if (window.web3) { // eslint-disable-line no-undef\n    window.web3 = new Web3(web3.currentProvider); // eslint-disable-line no-undef\n\n    accounts = await accountsPromise;\n\n    dispatch({\n      type: 'UPDATE_ADDRESSES',\n      isSignedIntoWallet: accounts.length > 0 || store.getState().threeBox.currentWallet === 'isToshi',\n      isLoggedIn: accounts && Box.isLoggedIn(accounts[0]), // eslint-disable-line no-undef\n    });\n  } else {\n    console.log('Non-Ethereum browser detected. You should consider trying MetaMask!');\n  }\n};\n\n// if has web3 wallet\nexport const checkNetwork = () => async (dispatch) => {\n  const checkNetworkFunc = new Promise((resolve) => {\n    window.web3.version.getNetwork((err, netId) => { // eslint-disable-line no-undef\n      switch (netId) {\n        case '1':\n          resolve('Main');\n          break;\n        case '2':\n          resolve('Morder');\n          break;\n        case '3':\n          resolve('Ropsten');\n          break;\n        case '4':\n          resolve('Rinkeby');\n          break;\n        case '42':\n          resolve('Kovan');\n          break;\n        default:\n          resolve('Unknown');\n      }\n    });\n  });\n\n  // // check network, compatible with old & new v of MetaMask\n  let currentNetwork;\n  if (window.web3.eth.net) { // eslint-disable-line no-undef\n    await window.web3.eth.net.getNetworkType() // eslint-disable-line no-undef\n      .then((network) => {\n        currentNetwork = network;\n      });\n  } else {\n    await checkNetworkFunc.then((network) => {\n      currentNetwork = network;\n    });\n  }\n\n  const prevPrevNetwork = window.localStorage.getItem('prevNetwork'); // eslint-disable-line no-undef\n  const prevNetwork = window.localStorage.getItem('currentNetwork'); // eslint-disable-line no-undef\n\n  const shouldShowSwitchNetwork = window.localStorage.getItem('shouldShowSwitchNetwork'); // eslint-disable-line no-undef\n  window.localStorage.setItem('prevPrevNetwork', prevPrevNetwork); // eslint-disable-line no-undef\n  window.localStorage.setItem('prevNetwork', prevNetwork); // eslint-disable-line no-undef\n  window.localStorage.setItem('currentNetwork', currentNetwork); // eslint-disable-line no-undef\n\n  if (prevNetwork && (prevNetwork !== currentNetwork) && store.getState().threeBox.isLoggedIn && shouldShowSwitchNetwork === 'true') {\n    window.localStorage.setItem('shouldShowSwitchNetwork', false); // eslint-disable-line no-undef\n    dispatch({\n      type: 'DIFFERENT_NETWORK',\n      showDifferentNetworkModal: true,\n      currentNetwork,\n      prevNetwork,\n      prevPrevNetwork,\n    });\n  } else {\n    window.localStorage.setItem('shouldShowSwitchNetwork', true); // eslint-disable-line no-undef\n    dispatch({\n      type: 'UPDATE_NETWORK',\n      currentNetwork,\n      prevNetwork,\n      prevPrevNetwork,\n    });\n  }\n};\n\nexport const getBox = fromSignIn => async (dispatch) => {\n  dispatch({\n    type: 'HANDLE_CONSENT_MODAL',\n    provideConsent: true,\n  });\n\n  const consentGiven = () => {\n    if (fromSignIn) history.push(routes.PROFILE);\n    dispatch({\n      type: 'LOADING_3BOX',\n    });\n    dispatch({\n      type: 'LOADING_ACTIVITY',\n    });\n  };\n\n  const opts = {\n    consentCallback: consentGiven,\n  };\n\n  try {\n    const box = await Box // eslint-disable-line no-undef\n      .openBox(\n        store.getState().threeBox.accountAddress || address,\n        window.web3.currentProvider, // eslint-disable-line no-undef\n        opts,\n      );\n\n    dispatch({\n      type: 'UPDATE_THREEBOX',\n      ifFetchingThreeBox: false,\n      isLoggedIn: true,\n      box,\n    });\n\n    const memberSince = await store.getState().threeBox.box.public.get('memberSince');\n    \n    box.onSyncDone(() => {\n      const publicActivity = store.getState().threeBox.box.public.log;\n      const privateActivity = store.getState().threeBox.box.private.log;\n\n      if (!privateActivity.length && !publicActivity.length) {\n        dispatch({\n          type: 'HANDLE_ONBOARDING_MODAL',\n          onBoardingModal: true,\n        });\n        const date = Date.now();\n        const dateJoined = new Date(date);\n        const memberSinceDate = `${(dateJoined.getMonth() + 1)}/${dateJoined.getDate()}/${dateJoined.getFullYear()}`;\n        store.getState().threeBox.box.public.set('memberSince', dateJoined);\n        dispatch({\n          type: 'GET_PUBLIC_MEMBERSINCE',\n          memberSince: memberSinceDate,\n        });\n        history.push(routes.EDITPROFILE);\n      } else if (!memberSince && (privateActivity.length || publicActivity.length)) {\n        store.getState().threeBox.box.public.set('memberSince', 'Alpha');\n      }\n\n      dispatch({\n        type: 'UPDATE_THREEBOX',\n        ifFetchingThreeBox: false,\n        isLoggedIn: true,\n        box,\n      });\n    });\n  } catch (err) {\n    dispatch({\n      type: 'FAILED_LOADING_3BOX',\n      errorMessage: err,\n      showErrorModal: true,\n      provideConsent: false,\n    });\n  }\n};\n\nexport const getActivity = () => async (dispatch) => {\n  try {\n    dispatch({\n      type: 'LOADING_ACTIVITY',\n    });\n\n    const activity = await ThreeBoxActivity.get(address); // eslint-disable-line no-undef\n\n    // add datatype\n    activity.internal = activity.internal.map(object => Object.assign({\n      dataType: 'Internal',\n    }, object));\n    activity.txs = activity.txs.map(object => Object.assign({\n      dataType: 'Txs',\n    }, object));\n    activity.token = activity.token.map(object => Object.assign({\n      dataType: 'Token',\n    }, object));\n\n    let publicActivity = await store.getState().threeBox.box.public.log;\n    let privateActivity = await store.getState().threeBox.box.private.log;\n\n    publicActivity = publicActivity.map((object) => {\n      object.timeStamp = object.timeStamp && object.timeStamp.toString().substring(0, 10);\n      return Object.assign({\n        dataType: 'Public',\n      }, object);\n    });\n    privateActivity = privateActivity.map((object) => {\n      object.timeStamp = object.timeStamp && object.timeStamp.toString().substring(0, 10);\n      return Object.assign({\n        dataType: 'Private',\n      }, object);\n    });\n\n    const feed = activity.internal\n      .concat(activity.txs)\n      .concat(activity.token)\n      .concat(publicActivity)\n      .concat(privateActivity);\n\n    // if timestamp is undefined, give it the timestamp of the previous entry\n    feed.map((item, i) => {\n      const feedItem = item;\n      if (!feedItem.timeStamp) {\n        const deletedTime = parseInt(feed[i - 1].timeStamp, 10) + 1;\n        feedItem.timeStamp = deletedTime.toString();\n      }\n      return feedItem;\n    });\n\n    feed.sort((a, b) => b.timeStamp - a.timeStamp);\n\n    // order feed chronologically and by address\n    const feedByAddress = [];\n    feed.forEach((item) => {\n      const othersAddress = item.from === address ? item.to : item.from;\n      if (feedByAddress.length > 0 &&\n        Object.keys(feedByAddress[feedByAddress.length - 1])[0] === othersAddress) {\n        feedByAddress[feedByAddress.length - 1][othersAddress].push(item);\n      } else if (feedByAddress.length > 0 && Object.keys(feedByAddress[feedByAddress.length - 1])[0] === 'threeBox' && (item.dataType === 'Public' || item.dataType === 'Private')) {\n        feedByAddress[feedByAddress.length - 1].threeBox.push(item);\n      } else if (item.dataType === 'Public' || item.dataType === 'Private') {\n        feedByAddress.push({\n          threeBox: [item],\n        });\n      } else {\n        feedByAddress.push({\n          [othersAddress]: [item],\n        });\n      }\n    });\n\n    dispatch({\n      type: 'UPDATE_ACTIVITY',\n      feedByAddress,\n      ifFetchingActivity: false,\n      isLoggedIn: true,\n    });\n  } catch (err) {\n    dispatch({\n      type: 'FAILED_LOADING_ACTIVITY',\n      feedByAddress: [],\n      ifFetchingActivity: false,\n      errorMessage: err,\n      showErrorModal: true,\n      provideConsent: false,\n    });\n  }\n};\n\nexport const getPublicName = () => async (dispatch) => {\n  const name = await store.getState().threeBox.box.public.get('name');\n\n  dispatch({\n    type: 'GET_PUBLIC_NAME',\n    name,\n  });\n};\n\nexport const getPublicGithub = () => async (dispatch) => {\n  const github = await store.getState().threeBox.box.public.get('github');\n\n  dispatch({\n    type: 'GET_PUBLIC_GITHUB',\n    github,\n  });\n};\n\nexport const getPublicDescription = () => async (dispatch) => {\n  const description = await store.getState().threeBox.box.public.get('description');\n\n  dispatch({\n    type: 'GET_PUBLIC_DESCRIPTION',\n    description,\n  });\n};\n\nexport const getPublicLocation = () => async (dispatch) => {\n  const location = await store.getState().threeBox.box.public.get('location');\n\n  dispatch({\n    type: 'GET_PUBLIC_LOCATION',\n    location,\n  });\n};\n\nexport const getPublicWebsite = () => async (dispatch) => {\n  const website = await store.getState().threeBox.box.public.get('website');\n\n  dispatch({\n    type: 'GET_PUBLIC_WEBSITE',\n    website,\n  });\n};\n\nexport const getPublicEmployer = () => async (dispatch) => {\n  const employer = await store.getState().threeBox.box.public.get('employer');\n\n  dispatch({\n    type: 'GET_PUBLIC_EMPLOYER',\n    employer,\n  });\n};\n\nexport const getPublicJob = () => async (dispatch) => {\n  const job = await store.getState().threeBox.box.public.get('job');\n\n  dispatch({\n    type: 'GET_PUBLIC_JOB',\n    job,\n  });\n};\n\nexport const getPublicMemberSince = () => async (dispatch) => {\n  const date = await store.getState().threeBox.box.public.get('memberSince');\n  const memberSince = date && new Date(date);\n  const memberSinceDate = date && `${(memberSince.getMonth() + 1)}/${memberSince.getDate()}/${memberSince.getFullYear()}`;\n\n  dispatch({\n    type: 'GET_PUBLIC_MEMBERSINCE',\n    memberSince: memberSinceDate,\n  });\n};\n\nexport const getPublicSchool = () => async (dispatch) => {\n  const school = await store.getState().threeBox.box.public.get('school');\n\n  dispatch({\n    type: 'GET_PUBLIC_SCHOOL',\n    school,\n  });\n};\n\nexport const getPublicDegree = () => async (dispatch) => {\n  const degree = await store.getState().threeBox.box.public.get('degree');\n\n  dispatch({\n    type: 'GET_PUBLIC_DEGREE',\n    degree,\n  });\n};\n\nexport const getPublicImage = () => async (dispatch) => {\n  const image = await store.getState().threeBox.box.public.get('image');\n\n  dispatch({\n    type: 'GET_PUBLIC_IMAGE',\n    image,\n  });\n};\n\nexport const getPublicCoverPhoto = () => async (dispatch) => {\n  const coverPhoto = await store.getState().threeBox.box.public.get('coverPhoto');\n\n  dispatch({\n    type: 'GET_PUBLIC_COVERPHOTO',\n    coverPhoto,\n  });\n};\n\nexport const getPublicEmoji = () => async (dispatch) => {\n  const emoji = await store.getState().threeBox.box.public.get('emoji');\n\n  dispatch({\n    type: 'GET_PUBLIC_EMOJI',\n    emoji,\n  });\n};\n\nexport const getPublicSubject = () => async (dispatch) => {\n  const major = await store.getState().threeBox.box.public.get('major');\n\n  dispatch({\n    type: 'GET_PUBLIC_MAJOR',\n    major,\n  });\n};\n\nexport const getPublicYear = () => async (dispatch) => {\n  const year = await store.getState().threeBox.box.public.get('year');\n\n  dispatch({\n    type: 'GET_PUBLIC_YEAR',\n    year,\n  });\n};\n\nexport const getPrivateEmail = () => async (dispatch) => {\n  const email = await store.getState().threeBox.box.private.get('email');\n\n  dispatch({\n    type: 'GET_PRIVATE_EMAIL',\n    email,\n  });\n};\n\nexport const getPrivateBirthday = () => async (dispatch) => {\n  const birthday = await store.getState().threeBox.box.private.get('birthday');\n\n  dispatch({\n    type: 'GET_PRIVATE_BIRTHDAY',\n    birthday,\n  });\n};\n\nexport const getPublicStatus = () => async (dispatch) => {\n  const status = await store.getState().threeBox.box.public.get('status');\n\n  dispatch({\n    type: 'GET_PUBLIC_STATUS',\n    status,\n  });\n};\n\nexport const handleSignOut = () => async (dispatch) => {\n  if (store.getState().threeBox.isLoggedIn) {\n    store.getState().threeBox.box.logout();\n    dispatch({\n      type: 'HANDLE_SIGNOUT',\n      isLoggedIn: false,\n    });\n  }\n  history.push(routes.LANDING);\n};\n\n\n// export const signInGetBox = () => async (dispatch) => {\n//   dispatch({\n//     type: 'HANDLE_CONSENT_MODAL',\n//     provideConsent: true,\n//   });\n\n//   const consentGiven = () => {\n//     history.push(routes.PROFILE);\n//     dispatch({\n//       type: 'LOADING_3BOX',\n//     });\n//     dispatch({\n//       type: 'LOADING_ACTIVITY',\n//     });\n//   };\n\n//   const opts = {\n//     consentCallback: consentGiven,\n//   };\n\n//   try {\n//     const box = await Box // eslint-disable-line no-undef\n//       .openBox(\n//         store.getState().threeBox.accountAddress || address,\n//         window.web3.currentProvider, // eslint-disable-line no-undef\n//         opts,\n//       );\n\n//     dispatch({\n//       type: 'UPDATE_THREEBOX',\n//       ifFetchingThreeBox: false,\n//       isLoggedIn: true,\n//       box,\n//     });\n\n//     const memberSince = await store.getState().threeBox.box.public.get('memberSince');\n\n//     box.onSyncDone(() => {\n//       const publicActivity = store.getState().threeBox.box.public.log;\n//       const privateActivity = store.getState().threeBox.box.private.log;\n//       if (!privateActivity.length && !publicActivity.length) {\n//         dispatch({\n//           type: 'HANDLE_ONBOARDING_MODAL',\n//           onBoardingModal: true,\n//         });\n//         store.getState().threeBox.box.public.set('memberSince', Date.now());\n//         history.push(routes.EDITPROFILE);\n//       } else if (!memberSince && (privateActivity.length || publicActivity.length)) {\n//         store.getState().threeBox.box.public.set('memberSince', 'Alpha');\n//       }\n\n//       dispatch({\n//         type: 'UPDATE_THREEBOX',\n//         ifFetchingThreeBox: false,\n//         isLoggedIn: true,\n//         box,\n//       });\n//     });\n//   } catch (err) {\n//     dispatch({\n//       type: 'FAILED_LOADING_3BOX',\n//       errorMessage: err,\n//       showErrorModal: true,\n//       provideConsent: false,\n//     });\n//   }\n// };\n\n// export const profileGetBox = () => async (dispatch) => {\n//   dispatch({\n//     type: 'HANDLE_CONSENT_MODAL',\n//     provideConsent: true,\n//   });\n\n//   const consentGiven = () => {\n//     dispatch({\n//       type: 'LOADING_3BOX',\n//     });\n//     dispatch({\n//       type: 'LOADING_ACTIVITY',\n//     });\n//   };\n\n//   const opts = {\n//     consentCallback: consentGiven,\n//   };\n\n//   try {\n//     const box = await Box // eslint-disable-line no-undef\n//       .openBox(\n//         store.getState().threeBox.accountAddress || address,\n//         window.web3.currentProvider, // eslint-disable-line no-undef\n//         opts,\n//       );\n\n//     dispatch({\n//       type: 'UPDATE_THREEBOX',\n//       ifFetchingThreeBox: false,\n//       box,\n//       isLoggedIn: true,\n//     });\n\n//     const memberSince = await store.getState().threeBox.box.public.get('memberSince');\n\n//     box.onSyncDone(() => {\n//       const publicActivity = store.getState().threeBox.box.public.log;\n//       const privateActivity = store.getState().threeBox.box.private.log;\n//       if (!privateActivity.length && !publicActivity.length) {\n//         dispatch({\n//           type: 'HANDLE_ONBOARDING_MODAL',\n//           onBoardingModal: true,\n//         });\n//         history.push(routes.EDITPROFILE);\n//       } else if (!memberSince && (privateActivity.length || publicActivity.length)) {\n//         store.getState().threeBox.box.public.set('memberSince', 'Alpha');\n//       }\n\n//       dispatch({\n//         type: 'UPDATE_THREEBOX',\n//         ifFetchingThreeBox: false,\n//         isLoggedIn: true,\n//         box,\n//       });\n//     });\n//   } catch (err) {\n//     dispatch({\n//       type: 'FAILED_LOADING_3BOX',\n//       errorMessage: err,\n//       showErrorModal: true,\n//       provideConsent: false,\n//     });\n//   }\n// };"]},"metadata":{},"sourceType":"module"}