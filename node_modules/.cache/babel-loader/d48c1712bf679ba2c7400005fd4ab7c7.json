{"ast":null,"code":"'use strict';\n\nvar toPull = require('stream-to-pull-stream');\n\nvar through = require('pull-through');\n\nvar createRabin;\n\nmodule.exports = function (options) {\n  if (!createRabin) {\n    try {\n      createRabin = require('rabin');\n\n      if (typeof createRabin !== 'function') {\n        throw new Error('createRabin was not a function');\n      }\n    } catch (err) {\n      var error = new Error(\"Rabin chunker not available, it may have failed to install or not be supported on this platform\");\n      return through(function () {\n        this.emit('error', error);\n      });\n    }\n  }\n\n  var min, max, avg;\n\n  if (options.minChunkSize && options.maxChunkSize && options.avgChunkSize) {\n    avg = options.avgChunkSize;\n    min = options.minChunkSize;\n    max = options.maxChunkSize;\n  } else {\n    avg = options.avgChunkSize;\n    min = avg / 3;\n    max = avg + avg / 2;\n  }\n\n  var sizepow = Math.floor(Math.log2(avg));\n  var rabin = createRabin({\n    min: min,\n    max: max,\n    bits: sizepow,\n    window: options.window || 16,\n    polynomial: options.polynomial || '0x3DF305DFB2A805'\n  });\n  return toPull.duplex(rabin);\n};","map":null,"metadata":{},"sourceType":"script"}