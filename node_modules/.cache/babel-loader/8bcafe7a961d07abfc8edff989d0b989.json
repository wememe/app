{"ast":null,"code":"import _regeneratorRuntime from \"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _slicedToArray from \"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _asyncToGenerator from \"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { store } from '../state/store';\nimport { accountsPromise } from '../state/actions'; // export let address =\n//   typeof window.web3 !== 'undefined' ? window.web3.eth.accounts[0] : ''; // eslint-disable-line no-undef\n\nvar address;\n\nvar getAddress = function getAddress() {\n  return (\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      var _window$web3$eth$acco, returnedAddress, _returnedAddress;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (!(typeof window.web3 !== 'undefined')) {\n                _context.next = 13;\n                break;\n              }\n\n              if (!window.web3.eth.accounts[0]) {\n                _context.next = 6;\n                break;\n              }\n\n              _window$web3$eth$acco = _slicedToArray(window.web3.eth.accounts, 1);\n              address = _window$web3$eth$acco[0];\n              _context.next = 11;\n              break;\n\n            case 6:\n              _context.next = 8;\n              return accountsPromise;\n\n            case 8:\n              returnedAddress = _context.sent;\n              _returnedAddress = _slicedToArray(returnedAddress, 1);\n              address = _returnedAddress[0];\n\n            case 11:\n              _context.next = 14;\n              break;\n\n            case 13:\n              address = null;\n\n            case 14:\n              store.dispatch({\n                type: 'HANDLE_LOGGEDOUT_MODAL',\n                loggedOutModal: true,\n                currentAddress: address\n              });\n\n            case 15:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, this);\n    }))\n  );\n};\n\ngetAddress();\n\nvar pollNetworkAndAddress = function pollNetworkAndAddress() {\n  setTimeout(function () {\n    var prevAddress;\n    var currentAddress = typeof window.web3 !== 'undefined' ? window.web3.eth.accounts[0] : ''; // eslint-disable-line no-undef\n    // Logged out of MM while logged in to 3Box\n\n    if (currentAddress !== address && currentAddress === undefined && store.getState().threeBox.isLoggedIn) {\n      prevAddress = address;\n      store.dispatch({\n        type: 'HANDLE_LOGGEDOUT_MODAL',\n        loggedOutModal: true,\n        currentAddress: currentAddress\n      });\n      window.localStorage.setItem('userEthAddress', currentAddress);\n    } // Logs out of 3Box\n\n\n    if (currentAddress !== address && currentAddress === undefined && store.getState().threeBox.isLoggedIn) {\n      store.dispatch({\n        type: 'HANDLE_LOGGEDOUT_MODAL',\n        loggedOutModal: true,\n        currentAddress: currentAddress\n      });\n      window.localStorage.setItem('userEthAddress', currentAddress);\n    } // Switched address\n\n\n    if (currentAddress !== address && typeof currentAddress === 'string' && currentAddress !== prevAddress && address !== undefined && store.getState().threeBox.isLoggedIn) {\n      prevAddress = address;\n      store.dispatch({\n        type: 'HANDLE_SWITCHED_ADDRESS_MODAL',\n        switchedAddressModal: true,\n        prevAddress: prevAddress,\n        currentAddress: currentAddress\n      });\n      window.localStorage.setItem('userEthAddress', currentAddress);\n    } // Switched back to previous address\n\n\n    if (currentAddress !== address && typeof currentAddress === 'string' && typeof address === 'string' && store.getState().threeBox.isLoggedIn && currentAddress === prevAddress) {\n      store.dispatch({\n        type: 'HANDLE_SWITCHED_ADDRESS_MODAL',\n        switchedAddressModal: false,\n        prevAddress: '',\n        currentAddress: currentAddress\n      });\n      window.localStorage.setItem('userEthAddress', currentAddress);\n    } // Logged in to MM\n\n\n    if (currentAddress !== address && typeof currentAddress === 'string' && address === undefined && !window.ethereum) {\n      store.dispatch({\n        type: 'HANDLE_WALLET_LOGIN_DETECTED_MODAL',\n        isSignedIntoWallet: true,\n        hasWallet: true,\n        currentAddress: currentAddress\n      });\n      window.localStorage.setItem('userEthAddress', currentAddress);\n    } // Logged out of MM while not signed in to 3Box\n\n\n    if (currentAddress !== address && currentAddress === undefined) {\n      store.dispatch({\n        type: 'HANDLE_WALLET_LOGIN_DETECTED_MODAL',\n        isSignedIntoWallet: false,\n        hasWallet: false,\n        currentAddress: currentAddress\n      });\n      window.localStorage.setItem('userEthAddress', currentAddress);\n    }\n\n    address = currentAddress;\n    pollNetworkAndAddress();\n  }, 1000);\n};\n\npollNetworkAndAddress();\nexport default address;","map":{"version":3,"sources":["/Users/kenzo/Desktop/3box-dapp/src/utils/address.js"],"names":["store","accountsPromise","address","getAddress","window","web3","eth","accounts","returnedAddress","dispatch","type","loggedOutModal","currentAddress","pollNetworkAndAddress","setTimeout","prevAddress","undefined","getState","threeBox","isLoggedIn","localStorage","setItem","switchedAddressModal","ethereum","isSignedIntoWallet","hasWallet"],"mappings":";;;AAAA,SACEA,KADF,QAEO,gBAFP;AAGA,SACEC,eADF,QAEO,kBAFP,C,CAIA;AACA;;AAEA,IAAIC,OAAJ;;AAEA,IAAMC,UAAU,GAAG,SAAbA,UAAa;AAAA;AAAA;AAAA;AAAA;AAAA,6BAAM;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,oBACnB,OAAOC,MAAM,CAACC,IAAd,KAAuB,WADJ;AAAA;AAAA;AAAA;;AAAA,mBAEjBD,MAAM,CAACC,IAAP,CAAYC,GAAZ,CAAgBC,QAAhB,CAAyB,CAAzB,CAFiB;AAAA;AAAA;AAAA;;AAAA,qDAGPH,MAAM,CAACC,IAAP,CAAYC,GAAZ,CAAgBC,QAHT;AAGlBL,cAAAA,OAHkB;AAAA;AAAA;;AAAA;AAAA;AAAA,qBAKWD,eALX;;AAAA;AAKbO,cAAAA,eALa;AAAA,gDAMPA,eANO;AAMlBN,cAAAA,OANkB;;AAAA;AAAA;AAAA;;AAAA;AASrBA,cAAAA,OAAO,GAAG,IAAV;;AATqB;AAWvBF,cAAAA,KAAK,CAACS,QAAN,CAAe;AACbC,gBAAAA,IAAI,EAAE,wBADO;AAEbC,gBAAAA,cAAc,EAAE,IAFH;AAGbC,gBAAAA,cAAc,EAAEV;AAHH,eAAf;;AAXuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAN;AAAA;AAAA,CAAnB;;AAkBAC,UAAU;;AAEV,IAAMU,qBAAqB,GAAG,SAAxBA,qBAAwB,GAAM;AAClCC,EAAAA,UAAU,CAAC,YAAM;AACf,QAAIC,WAAJ;AACA,QAAMH,cAAc,GAAG,OAAOR,MAAM,CAACC,IAAd,KAAuB,WAAvB,GAAqCD,MAAM,CAACC,IAAP,CAAYC,GAAZ,CAAgBC,QAAhB,CAAyB,CAAzB,CAArC,GAAmE,EAA1F,CAFe,CAE+E;AAC9F;;AACA,QAAIK,cAAc,KAAKV,OAAnB,IACFU,cAAc,KAAKI,SADjB,IAEFhB,KAAK,CAACiB,QAAN,GAAiBC,QAAjB,CAA0BC,UAF5B,EAEwC;AACtCJ,MAAAA,WAAW,GAAGb,OAAd;AACAF,MAAAA,KAAK,CAACS,QAAN,CAAe;AACbC,QAAAA,IAAI,EAAE,wBADO;AAEbC,QAAAA,cAAc,EAAE,IAFH;AAGbC,QAAAA,cAAc,EAAdA;AAHa,OAAf;AAKAR,MAAAA,MAAM,CAACgB,YAAP,CAAoBC,OAApB,CAA4B,gBAA5B,EAA8CT,cAA9C;AACD,KAdc,CAgBf;;;AACA,QAAIA,cAAc,KAAKV,OAAnB,IACFU,cAAc,KAAKI,SADjB,IAEFhB,KAAK,CAACiB,QAAN,GAAiBC,QAAjB,CAA0BC,UAF5B,EAEwC;AACtCnB,MAAAA,KAAK,CAACS,QAAN,CAAe;AACbC,QAAAA,IAAI,EAAE,wBADO;AAEbC,QAAAA,cAAc,EAAE,IAFH;AAGbC,QAAAA,cAAc,EAAdA;AAHa,OAAf;AAKAR,MAAAA,MAAM,CAACgB,YAAP,CAAoBC,OAApB,CAA4B,gBAA5B,EAA8CT,cAA9C;AACD,KA1Bc,CA4Bf;;;AACA,QAAIA,cAAc,KAAKV,OAAnB,IACF,OAAOU,cAAP,KAA0B,QADxB,IAEFA,cAAc,KAAKG,WAFjB,IAGFb,OAAO,KAAKc,SAHV,IAIFhB,KAAK,CAACiB,QAAN,GAAiBC,QAAjB,CAA0BC,UAJ5B,EAIwC;AACtCJ,MAAAA,WAAW,GAAGb,OAAd;AACAF,MAAAA,KAAK,CAACS,QAAN,CAAe;AACbC,QAAAA,IAAI,EAAE,+BADO;AAEbY,QAAAA,oBAAoB,EAAE,IAFT;AAGbP,QAAAA,WAAW,EAAXA,WAHa;AAIbH,QAAAA,cAAc,EAAdA;AAJa,OAAf;AAMAR,MAAAA,MAAM,CAACgB,YAAP,CAAoBC,OAApB,CAA4B,gBAA5B,EAA8CT,cAA9C;AACD,KA1Cc,CA4Cf;;;AACA,QAAIA,cAAc,KAAKV,OAAnB,IACF,OAAOU,cAAP,KAA0B,QADxB,IAEF,OAAOV,OAAP,KAAmB,QAFjB,IAGFF,KAAK,CAACiB,QAAN,GAAiBC,QAAjB,CAA0BC,UAHxB,IAIFP,cAAc,KAAKG,WAJrB,EAKE;AACAf,MAAAA,KAAK,CAACS,QAAN,CAAe;AACbC,QAAAA,IAAI,EAAE,+BADO;AAEbY,QAAAA,oBAAoB,EAAE,KAFT;AAGbP,QAAAA,WAAW,EAAE,EAHA;AAIbH,QAAAA,cAAc,EAAdA;AAJa,OAAf;AAMAR,MAAAA,MAAM,CAACgB,YAAP,CAAoBC,OAApB,CAA4B,gBAA5B,EAA8CT,cAA9C;AACD,KA1Dc,CA4Df;;;AACA,QAAIA,cAAc,KAAKV,OAAnB,IACF,OAAOU,cAAP,KAA0B,QADxB,IAEFV,OAAO,KAAKc,SAFV,IAGF,CAACZ,MAAM,CAACmB,QAHV,EAGoB;AAClBvB,MAAAA,KAAK,CAACS,QAAN,CAAe;AACbC,QAAAA,IAAI,EAAE,oCADO;AAEbc,QAAAA,kBAAkB,EAAE,IAFP;AAGbC,QAAAA,SAAS,EAAE,IAHE;AAIbb,QAAAA,cAAc,EAAdA;AAJa,OAAf;AAMAR,MAAAA,MAAM,CAACgB,YAAP,CAAoBC,OAApB,CAA4B,gBAA5B,EAA8CT,cAA9C;AACD,KAxEc,CA0Ef;;;AACA,QAAIA,cAAc,KAAKV,OAAnB,IACFU,cAAc,KAAKI,SADrB,EACgC;AAC9BhB,MAAAA,KAAK,CAACS,QAAN,CAAe;AACbC,QAAAA,IAAI,EAAE,oCADO;AAEbc,QAAAA,kBAAkB,EAAE,KAFP;AAGbC,QAAAA,SAAS,EAAE,KAHE;AAIbb,QAAAA,cAAc,EAAdA;AAJa,OAAf;AAMAR,MAAAA,MAAM,CAACgB,YAAP,CAAoBC,OAApB,CAA4B,gBAA5B,EAA8CT,cAA9C;AACD;;AAEDV,IAAAA,OAAO,GAAGU,cAAV;AACAC,IAAAA,qBAAqB;AACtB,GAxFS,EAwFP,IAxFO,CAAV;AAyFD,CA1FD;;AA4FAA,qBAAqB;AAErB,eAAeX,OAAf","sourcesContent":["import {\n  store,\n} from '../state/store';\nimport {\n  accountsPromise,\n} from '../state/actions';\n\n// export let address =\n//   typeof window.web3 !== 'undefined' ? window.web3.eth.accounts[0] : ''; // eslint-disable-line no-undef\n\nlet address;\n\nconst getAddress = () => async () => {\n  if (typeof window.web3 !== 'undefined') {\n    if (window.web3.eth.accounts[0]) {\n      [address] = window.web3.eth.accounts;\n    } else {\n      const returnedAddress = await accountsPromise;\n      [address] = returnedAddress;\n    }\n  } else {\n    address = null;\n  }\n  store.dispatch({\n    type: 'HANDLE_LOGGEDOUT_MODAL',\n    loggedOutModal: true,\n    currentAddress: address,\n  });\n};\n\ngetAddress();\n\nconst pollNetworkAndAddress = () => {\n  setTimeout(() => {\n    let prevAddress;\n    const currentAddress = typeof window.web3 !== 'undefined' ? window.web3.eth.accounts[0] : ''; // eslint-disable-line no-undef\n    // Logged out of MM while logged in to 3Box\n    if (currentAddress !== address &&\n      currentAddress === undefined &&\n      store.getState().threeBox.isLoggedIn) {\n      prevAddress = address;\n      store.dispatch({\n        type: 'HANDLE_LOGGEDOUT_MODAL',\n        loggedOutModal: true,\n        currentAddress,\n      });\n      window.localStorage.setItem('userEthAddress', currentAddress);\n    }\n\n    // Logs out of 3Box\n    if (currentAddress !== address &&\n      currentAddress === undefined &&\n      store.getState().threeBox.isLoggedIn) {\n      store.dispatch({\n        type: 'HANDLE_LOGGEDOUT_MODAL',\n        loggedOutModal: true,\n        currentAddress,\n      });\n      window.localStorage.setItem('userEthAddress', currentAddress);\n    }\n\n    // Switched address\n    if (currentAddress !== address &&\n      typeof currentAddress === 'string' &&\n      currentAddress !== prevAddress &&\n      address !== undefined &&\n      store.getState().threeBox.isLoggedIn) {\n      prevAddress = address;\n      store.dispatch({\n        type: 'HANDLE_SWITCHED_ADDRESS_MODAL',\n        switchedAddressModal: true,\n        prevAddress,\n        currentAddress,\n      });\n      window.localStorage.setItem('userEthAddress', currentAddress);\n    }\n\n    // Switched back to previous address\n    if (currentAddress !== address &&\n      typeof currentAddress === 'string' &&\n      typeof address === 'string' &&\n      store.getState().threeBox.isLoggedIn &&\n      currentAddress === prevAddress\n    ) {\n      store.dispatch({\n        type: 'HANDLE_SWITCHED_ADDRESS_MODAL',\n        switchedAddressModal: false,\n        prevAddress: '',\n        currentAddress,\n      });\n      window.localStorage.setItem('userEthAddress', currentAddress);\n    }\n\n    // Logged in to MM\n    if (currentAddress !== address &&\n      typeof currentAddress === 'string' &&\n      address === undefined &&\n      !window.ethereum) {\n      store.dispatch({\n        type: 'HANDLE_WALLET_LOGIN_DETECTED_MODAL',\n        isSignedIntoWallet: true,\n        hasWallet: true,\n        currentAddress,\n      });\n      window.localStorage.setItem('userEthAddress', currentAddress);\n    }\n\n    // Logged out of MM while not signed in to 3Box\n    if (currentAddress !== address &&\n      currentAddress === undefined) {\n      store.dispatch({\n        type: 'HANDLE_WALLET_LOGIN_DETECTED_MODAL',\n        isSignedIntoWallet: false,\n        hasWallet: false,\n        currentAddress,\n      });\n      window.localStorage.setItem('userEthAddress', currentAddress);\n    }\n\n    address = currentAddress;\n    pollNetworkAndAddress();\n  }, 1000);\n};\n\npollNetworkAndAddress();\n\nexport default address;"]},"metadata":{},"sourceType":"module"}