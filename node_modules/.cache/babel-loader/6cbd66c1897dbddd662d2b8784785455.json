{"ast":null,"code":"var util = require('util');\n\nvar AbstractIterator = require('abstract-leveldown').AbstractIterator;\n\nfunction DeferredIterator(options) {\n  AbstractIterator.call(this, options);\n  this._options = options;\n  this._iterator = null;\n  this._operations = [];\n}\n\nutil.inherits(DeferredIterator, AbstractIterator);\n\nDeferredIterator.prototype.setDb = function (db) {\n  var it = this._iterator = db.iterator(this._options);\n\n  this._operations.forEach(function (op) {\n    it[op.method].apply(it, op.args);\n  });\n};\n\nDeferredIterator.prototype._operation = function (method, args) {\n  if (this._iterator) return this._iterator[method].apply(this._iterator, args);\n\n  this._operations.push({\n    method: method,\n    args: args\n  });\n};\n\n'next end'.split(' ').forEach(function (m) {\n  DeferredIterator.prototype['_' + m] = function () {\n    this._operation(m, arguments);\n  };\n});\nmodule.exports = DeferredIterator;","map":null,"metadata":{},"sourceType":"script"}