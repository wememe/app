{"ast":null,"code":"'use strict';\n\nvar Key = require('interface-datastore').Key;\n\nvar sortKeys = require('sort-keys');\n\nvar specKey = new Key('datastore_spec');\n\nmodule.exports = function (store) {\n  return {\n    /**\n     * Check if a datastore spec file exists.\n     *\n     * @param {function(Error, bool)} callback\n     * @returns {void}\n     */\n    exists: function exists(callback) {\n      store.has(specKey, callback);\n    },\n\n    /**\n     * Get the current datastore spec.\n     *\n     * @param {function(Error, number)} callback\n     * @returns {void}\n     */\n    get: function get(callback) {\n      store.get(specKey, function (err, buf) {\n        if (err) {\n          return callback(err);\n        }\n\n        callback(null, JSON.parse(buf.toString()));\n      });\n    },\n\n    /**\n     * Set the datastore spec of the repo, writing it to the underlying store.\n     *\n     * @param {number} spec\n     * @param {function(Error)} callback\n     * @returns {void}\n     */\n    set: function set(spec, callback) {\n      store.put(specKey, Buffer.from(JSON.stringify(sortKeys(spec, {\n        deep: true\n      }))), callback);\n    }\n  };\n};","map":null,"metadata":{},"sourceType":"script"}