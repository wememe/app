{"ast":null,"code":"'use strict';\n\nvar pull = require('pull-stream');\n\nvar pullLP = require('pull-length-prefixed');\n\nvar varint = require('varint');\n\nfunction lsHandler(self, conn) {\n  var protos = Object.keys(self.handlers).filter(function (key) {\n    return key !== 'ls';\n  });\n  var nProtos = protos.length; // total size of the list of protocols, including varint and newline\n\n  var size = protos.reduce(function (size, proto) {\n    var p = Buffer.from(proto + '\\n');\n    var el = varint.encodingLength(p.length);\n    return size + el;\n  }, 0);\n  var buf = Buffer.concat([Buffer.from(varint.encode(nProtos)), Buffer.from(varint.encode(size)), Buffer.from('\\n')]);\n  var encodedProtos = protos.map(function (proto) {\n    return Buffer.from(proto + '\\n');\n  });\n  var values = [buf].concat(encodedProtos);\n  pull(pull.values(values), pullLP.encode(), conn);\n}\n\nmodule.exports = lsHandler;","map":null,"metadata":{},"sourceType":"script"}