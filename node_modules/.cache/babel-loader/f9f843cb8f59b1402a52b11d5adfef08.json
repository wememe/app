{"ast":null,"code":"'use strict';\n\nvar _regeneratorRuntime = require(\"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\");\n\nvar _asyncToGenerator = require(\"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar _classCallCheck = require(\"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _possibleConstructorReturn = require(\"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/possibleConstructorReturn\");\n\nvar _getPrototypeOf = require(\"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/inherits\");\n\nvar AccessController = require('./access-controller');\n\nvar IPFSAccessController =\n/*#__PURE__*/\nfunction (_AccessController) {\n  _inherits(IPFSAccessController, _AccessController);\n\n  function IPFSAccessController(ipfs) {\n    var _this;\n\n    _classCallCheck(this, IPFSAccessController);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(IPFSAccessController).call(this));\n    _this._ipfs = ipfs;\n    return _this;\n  }\n\n  _createClass(IPFSAccessController, [{\n    key: \"load\",\n    value: function () {\n      var _load = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(address) {\n        var dag, obj;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                // Transform '/ipfs/QmPFtHi3cmfZerxtH9ySLdzpg1yFhocYDZgEZywdUXHxFU'\n                // to 'QmPFtHi3cmfZerxtH9ySLdzpg1yFhocYDZgEZywdUXHxFU'\n                if (address.indexOf('/ipfs') === 0) address = address.split('/')[2];\n                _context.prev = 1;\n                _context.next = 4;\n                return this._ipfs.object.get(address);\n\n              case 4:\n                dag = _context.sent;\n                obj = JSON.parse(dag.toJSON().data);\n                this._access = obj;\n                _context.next = 12;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](1);\n                console.log(\"ACCESS ERROR:\", _context.t0);\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 9]]);\n      }));\n\n      function load(_x) {\n        return _load.apply(this, arguments);\n      }\n\n      return load;\n    }()\n  }, {\n    key: \"save\",\n    value: function () {\n      var _save = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2() {\n        var hash, access, dag;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.prev = 0;\n                access = JSON.stringify(this._access, null, 2);\n                _context2.next = 4;\n                return this._ipfs.object.put(new Buffer(access));\n\n              case 4:\n                dag = _context2.sent;\n                hash = dag.toJSON().multihash.toString();\n                _context2.next = 11;\n                break;\n\n              case 8:\n                _context2.prev = 8;\n                _context2.t0 = _context2[\"catch\"](0);\n                console.log(\"ACCESS ERROR:\", _context2.t0);\n\n              case 11:\n                return _context2.abrupt(\"return\", hash);\n\n              case 12:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this, [[0, 8]]);\n      }));\n\n      function save() {\n        return _save.apply(this, arguments);\n      }\n\n      return save;\n    }()\n  }]);\n\n  return IPFSAccessController;\n}(AccessController);\n\nmodule.exports = IPFSAccessController;","map":null,"metadata":{},"sourceType":"script"}