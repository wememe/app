{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = _filter;\n\nvar _arrayMap = require('lodash/_arrayMap');\n\nvar _arrayMap2 = _interopRequireDefault(_arrayMap);\n\nvar _isArrayLike = require('lodash/isArrayLike');\n\nvar _isArrayLike2 = _interopRequireDefault(_isArrayLike);\n\nvar _baseProperty = require('lodash/_baseProperty');\n\nvar _baseProperty2 = _interopRequireDefault(_baseProperty);\n\nvar _noop = require('lodash/noop');\n\nvar _noop2 = _interopRequireDefault(_noop);\n\nvar _wrapAsync = require('./wrapAsync');\n\nvar _wrapAsync2 = _interopRequireDefault(_wrapAsync);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction filterArray(eachfn, arr, iteratee, callback) {\n  var truthValues = new Array(arr.length);\n  eachfn(arr, function (x, index, callback) {\n    iteratee(x, function (err, v) {\n      truthValues[index] = !!v;\n      callback(err);\n    });\n  }, function (err) {\n    if (err) return callback(err);\n    var results = [];\n\n    for (var i = 0; i < arr.length; i++) {\n      if (truthValues[i]) results.push(arr[i]);\n    }\n\n    callback(null, results);\n  });\n}\n\nfunction filterGeneric(eachfn, coll, iteratee, callback) {\n  var results = [];\n  eachfn(coll, function (x, index, callback) {\n    iteratee(x, function (err, v) {\n      if (err) {\n        callback(err);\n      } else {\n        if (v) {\n          results.push({\n            index: index,\n            value: x\n          });\n        }\n\n        callback();\n      }\n    });\n  }, function (err) {\n    if (err) {\n      callback(err);\n    } else {\n      callback(null, (0, _arrayMap2.default)(results.sort(function (a, b) {\n        return a.index - b.index;\n      }), (0, _baseProperty2.default)('value')));\n    }\n  });\n}\n\nfunction _filter(eachfn, coll, iteratee, callback) {\n  var filter = (0, _isArrayLike2.default)(coll) ? filterArray : filterGeneric;\n  filter(eachfn, coll, (0, _wrapAsync2.default)(iteratee), callback || _noop2.default);\n}\n\nmodule.exports = exports['default'];","map":null,"metadata":{},"sourceType":"script"}