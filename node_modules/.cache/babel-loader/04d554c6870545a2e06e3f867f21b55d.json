{"ast":null,"code":"'use strict';\n\nvar _classCallCheck = require(\"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/kenzo/Desktop/3box-dapp/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar handshake = require('pull-handshake');\n\nvar deferred = require('pull-defer');\n\nvar State =\n/*#__PURE__*/\nfunction () {\n  function State(localId, remoteId, timeout, callback) {\n    _classCallCheck(this, State);\n\n    if (typeof timeout === 'function') {\n      callback = timeout;\n      timeout = undefined;\n    }\n\n    this.setup();\n    this.id.local = localId; // TODO use remoteId to verify PeersIdentity\n\n    this.id.remote = remoteId;\n    this.key.local = localId.privKey;\n    this.timeout = timeout || 60 * 1000;\n\n    callback = callback || function () {};\n\n    this.secure = deferred.duplex();\n    this.stream = handshake({\n      timeout: this.timeout\n    }, callback);\n    this.shake = this.stream.handshake;\n    delete this.stream.handshake;\n  }\n\n  _createClass(State, [{\n    key: \"setup\",\n    value: function setup() {\n      this.id = {\n        local: null,\n        remote: null\n      };\n      this.key = {\n        local: null,\n        remote: null\n      };\n      this.shake = null;\n      this.cleanSecrets();\n    } // remove all data from the handshake that is not needed anymore\n\n  }, {\n    key: \"cleanSecrets\",\n    value: function cleanSecrets() {\n      this.shared = {};\n      this.ephemeralKey = {\n        local: null,\n        remote: null\n      };\n      this.proposal = {\n        in: null,\n        out: null\n      };\n      this.proposalEncoded = {\n        in: null,\n        out: null\n      };\n      this.protocols = {\n        local: null,\n        remote: null\n      };\n      this.exchange = {\n        in: null,\n        out: null\n      };\n    }\n  }]);\n\n  return State;\n}();\n\nmodule.exports = State;","map":null,"metadata":{},"sourceType":"script"}